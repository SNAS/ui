<div class="relative" ng-style="{height: dualWindow == true ? '100%' : 'auto'}">
  <div class="loading" ng-class="{active: loading}">
      <span class="glyphicon glyphicon-refresh"></span>
  </div>

  <div ng-show="error" class="error">
    {{error}}
  </div>

  <div ng-show="location === 'globalView' || location === 'peerView'" class="map-control router-list" ng-class="{expanded: expandList, 'with-router': selectedRouter != undefined, 'active-location': selectedLocation != undefined, 'peers-only': selectedRouter === true}" ng-style="{ height: dualWindow == true ? '70%' : 'inherit' }">
    <div class="panel-search">
      <span class="glyphicon glyphicon-remove" ng-show="panelSearch" ng-click="panelSearch = ''"></span>
      <input type="text" placeholder="Search" class="search" ng-model="panelSearch" ng-click="expandPanelLocations()"/>
    </div>
    <h3 class="panel-header" ng-init="expandList = false" ng-click="expandList = !expandList">
      <strong class="pointer">&lt;</strong> {{panelTitle}}
    </h3>

    <div ng-show="selectedRouter != undefined && selectedRouter != true" class="panel-header selected-router">
      <div class="row">
        <div class="col-xs-6"><h3>{{selectedRouter.RouterName}}</h3></div>
        <div class="col-xs-6"><h3>{{selectedRouter.RouterIP}}</h3></div>
        <span ng-click="deselectPanelRouter()" class="remove-router">x</span>
      </div>
    </div>

    <div class="main" ng-class="{expanded: expandList, 'peers-only': selectedRouter === true, tall: !selectionMade}" ng-style="{ height: dualWindow == true ? '100%' : 'inherit' }">
      <ul class="locations" ng-hide="selectedRouter"  ng-style="{'max-height': panelHeight}">
        <li ng-repeat="location in locations | orderBy: 'options.city'" ng-hide="selectedRouter" ng-show="filteredRouters.length">
          <p class="router-list-city" ng-class="{expanded: location.expandRouters}" ng-click="selectPanelLocation(location)">
            <span class="glyphicon glyphicon-play"></span>{{location.options.city}}
            <span class="count">({{location.options.routers.length}})</span>
          </p>
          <span class="go-to-location glyphicon glyphicon-search" ng-click="goto(location)"></span>
          <ul class="routers" ng-show="location.expandRouters">
            <li ng-repeat="router in filteredRouters = (location.options.routers | filter:panelSearch)" ng-click="selectPanelRouter(location, router)">
              <div class="row">
                <div class="col-xs-6" tooltip-popup-delay="1000" tooltip="Name: {{router.RouterName}}" tooltip-placement="top">{{router.RouterName}}</div>
                <div class="col-xs-6">{{router.RouterIP}}</div>
              </div>
              <span class="is-up">
                <icon ng-show="router.isConnected" class="bmp-up"></icon>
                <icon ng-show="!router.isConnected" class="bmp-down"></icon>
              </span>
            </li>
          </ul>
        </li>
      </ul>

      <ul class="locations" ng-show="selectedRouter"  ng-style="{'max-height': panelHeight}">
        <li ng-attr-id="id{{location.options.id}}" ng-repeat="(latlng, location) in peerDictionary | orderBy: 'location.options.city'" ng-show="filteredPeers.length">
          <p class="router-list-city" ng-class="{expanded: location.options.expandPeers}" ng-click="selectPanelPeerLocation(location)">
            <span class="glyphicon glyphicon-play"></span>{{location.options.city}}
            <span class="count">({{location.options.peers.length}})</span>
          </p>
          <span class="go-to-location glyphicon glyphicon-search" ng-click="goto(location)"></span>
          <ul class="peers" ng-show="location.options.expandPeers">
            <li ng-repeat="peer in filteredPeers = (location.options.peers | filter:panelSearch)" ng-click="selectPanelPeer(location, peer)" tooltip-popup-delay="1000" tooltip="Router: {{peer.RouterName}}" tooltip-placement="bottom">
              <div class="row">
                <div class="col-xs-6" tooltip-popup-delay="1000" tooltip="Name: {{peer.PeerName}}" tooltip-placement="top">{{peer.PeerName}}</div>
                <div class="col-xs-6">{{peer.PeerIP}}</div>
              </div>
              <span class="is-up">
                <icon ng-show="peer.isUp" class="bmp-up"></icon>
                <icon ng-show="!peer.isUp" class="bmp-down"></icon>
              </span>
            </li>
          </ul>
        </li>
      </ul>
    </div>
  </div>

  <div ng-class="{active: activeInfo}" class="map-control info">
    <span>{{info}}</span>
  </div>


  <!--bottom pane-->
  <div class="bottom-pane" ng-show="!loading && location === 'globalView'">

    <div ng-class="{'top':!bottomPaneState}" class="collapsed-section">
      <div class="bmp-expand coll-icon" ng-click="bottomPaneState=!bottomPaneState"></div>
    </div>

    <!--expanded-->
    <div class="expanded-section" ng-show="!bottomPaneState && !loading">

      <nvd3 options="peerIpChartOptions" data="peerIpChartData" config="showChartsConfig" style="float: left;"></nvd3>

      <nvd3 options="peerChartUpOptions" data="peerChartUpData" config="showChartsConfig" style="float: left;"></nvd3>

      <nvd3 options="routerChartOptions" data="routerChartData" config="showChartsConfig" style="float: left;"></nvd3>

      <!--<div class="left">-->
        <!--<div>BMP ROUTER</div>-->
        <!--&lt;!&ndash;Router Boxes&ndash;&gt;-->
        <!--<div class="ip-section" style="background-color: #0266a0;">-->
          <!--&lt;!&ndash;top section&ndash;&gt;-->
          <!--<div style="width: 100%; height: 35px;">-->
            <!--&lt;!&ndash;top left //ipv4&ndash;&gt;-->
            <!--<div style="float:left;text-align: center">-->
              <!--&lt;!&ndash;type&ndash;&gt;UP-->
              <!--<br>-->
              <!--&lt;!&ndash;total&ndash;&gt;{{ routerTotals[1] }}-->
            <!--</div>-->
            <!--&lt;!&ndash;top right //ipv6&ndash;&gt;-->
            <!--<div style="float:right;text-align: center">-->
              <!--&lt;!&ndash;type&ndash;&gt;DOWN-->
              <!--<br>-->
              <!--&lt;!&ndash;total&ndash;&gt;{{ routerTotals[0] }}-->
            <!--</div>-->
          <!--</div>-->
          <!--&lt;!&ndash;bottom&ndash;&gt;-->
          <!--<div style="text-align: center">-->
            <!--&lt;!&ndash;total&ndash;&gt;<h3>{{ routerTotals[2] }}</h3>-->
            <!--&lt;!&ndash;type&ndash;&gt;TOTAL-->
          <!--</div>-->
        <!--</div>-->
      <!--</div>-->


      <!--Chart-->

      <div style="float: left">
        <div style="background-color: white;width: 600px;height: 129px;float: left;margin-top: 10px;color:#000000;">
          <nvd3 options="topChartOptions" data="topChartData"></nvd3>
        </div>
      </div>

      <!--<div style="float: left">-->
        <!--<div>PEER</div>-->
        <!--&lt;!&ndash;IP Boxes&ndash;&gt;-->
        <!--<div class="ip-section" ng-repeat="peer in bgpPeers" ng-style="{'background-color':peer.colour}">-->
          <!--&lt;!&ndash;top section&ndash;&gt;-->
          <!--<div style="width: 100%; height: 35px;">-->
            <!--&lt;!&ndash;top left //ipv4&ndash;&gt;-->
            <!--<div style="float:left;text-align: center">-->
              <!--&lt;!&ndash;type&ndash;&gt;v4-->
              <!--<br>-->
              <!--Peers-->
              <!--<br>-->
              <!--&lt;!&ndash;total&ndash;&gt;{{ peer.ipv4 }}-->
            <!--</div>-->
            <!--&lt;!&ndash;top right //ipv6&ndash;&gt;-->
            <!--<div style="float:right;text-align: center">-->
              <!--&lt;!&ndash;type&ndash;&gt;v6-->
              <!--<br>-->
              <!--Peers-->
              <!--<br>-->
              <!--&lt;!&ndash;total&ndash;&gt;{{ peer.ipv6 }}-->
            <!--</div>-->
          <!--</div>-->
          <!--&lt;!&ndash;bottom&ndash;&gt;-->
          <!--<div style="text-align: center">-->
            <!--&lt;!&ndash;total&ndash;&gt;<h3>{{ peer.total }}</h3>-->
            <!--&lt;!&ndash;type&ndash;&gt;{{ peer.type }}-->
          <!--</div>-->
        <!--</div>-->
      <!--</div>-->

    </div>

  </div>

  <leaflet ng-attr-id="{{id}}" class="map" defaults="defaults" height="{{mapHeight}}" width="100%" resize></leaflet>
</div>
